close all;
clear all;
clc;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Constants And Initial Conditions %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
T = 25; t = 0:0.1:T;    % Time

beta =1;                % Infected rate
delta =0.75;            % Recovery rate
b = .35;                % birth/death rate

N = 30;                 % Total number of nodes
I0 = 5;                 % Initial infected nodes
S0 = N - I0;            % Initial susceptible nodes

%%%%%%%%%%%%%%
%%% STEP 1 %%%
%%%%%%%%%%%%%%
dt = 0.1; t = 0:dt:T;   % Time
steps = T/dt;           % Number of time steps

I = zeros(steps+1,1);   % Infected nodes
I(1) = I0;              % Initial number of infected nodes

for k = 1:steps
    %%%%%%%%%%%%%%
    %%% STEP 2 %%%
    %%%%%%%%%%%%%%
    r = rand;           % random number
%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%      Events       %%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%
    e(1)=beta*I(k)*(N-I(k))/N*dt;        % Infection --->  (S, I) --> (S-1 , I+1)
    e(2)=b*I(k)*dt;                      % Death(I) ---->  (S, I) --> (S , I-1)
    e(3)=delta*I(k)*dt;                  % Susceptible ---->  (S, I) --> (S+1 , I-1)
   
    if r <= e(1)
        I(k+1) = I(k)+1;
    elseif (r > e(1)) && (r <= (e(2)+e(3)))
        I(k+1) = I(k)-1;
    elseif (r > (e(2)+e(3))) && (r <= 1)
        I(k+1) = I(k);
    end
end
 
S = N - I;              % Susceptible nodes

for k=1:length(t)
    plot(t(k), S(k),'go');
    plot(t(k), I(k),'ro');
    hold on
    plot(t(1:k), S(1:k),'go');
    plot(t(1:k), I(1:k),'ro');
    axis([0 25 0 30])
    grid on
    xlabel('Time in weeks')                      % t-axis label
    ylabel('Nodes')                              % N-axis label
    legend('Infected','Susceptible');
    pause(0.0001)
end





